{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "use-mor-balances",
  "type": "registry:hook",
  "title": "useMorBalances",
  "description": "Hook for fetching MOR token balances across multiple chains",
  "dependencies": [
    "wagmi"
  ],
  "registryDependencies": [
    "contracts"
  ],
  "files": [
    {
      "path": "registry/new-york/hooks/use-mor-balances/use-mor-balances.ts",
      "content": "\"use client\";\n\nimport { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { useAccount, useChainId } from \"wagmi\";\nimport { formatTokenAmount } from \"@morpheus-ui/registry\";\nimport { MAINNET_CONTRACTS, getChainConfig } from \"@morpheus-ui/registry\";\n\ninterface BalanceData {\n  address: string;\n  chainId: number;\n  balance: bigint;\n  formattedBalance: string;\n  symbol: string;\n  decimals: number;\n}\n\ninterface UseMorBalancesOptions {\n  pollInterval?: number;\n  enabled?: boolean;\n}\n\nexport function useMorBalances(options: UseMorBalancesOptions = {}) {\n  const { pollInterval = 60000, enabled = true } = options;\n  const { address, isConnected } = useAccount();\n  const currentChainId = useChainId();\n\n  const [balances, setBalances] = useState<Record<number, BalanceData>>({});\n  const [lastUpdated, setLastUpdated] = useState<Date | null>(null);\n\n  // Fetch balance for a specific chain\n  const fetchBalance = useCallback(\n    async (chainId: number) => {\n      if (!address) return null;\n\n      const contracts =\n        MAINNET_CONTRACTS[chainId as keyof typeof MAINNET_CONTRACTS];\n      if (!contracts) return null;\n\n      try {\n        // Get RPC URL from chain config\n        const chainConfig = getChainConfig(chainId as 8453 | 42161 | 84532);\n        const rpcUrl = chainConfig?.rpcUrl || `https://mainnet.base.org`;\n\n        const response = await fetch(rpcUrl, {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({\n            jsonrpc: \"2.0\",\n            method: \"eth_call\",\n            params: [\n              {\n                to: contracts.MORToken,\n                data:\n                  \"0x70a08231000000000000000000000000\" +\n                  address.slice(2).padStart(64, \"0\"),\n              },\n              \"latest\",\n            ],\n            id: 1,\n          }),\n        });\n\n        const data = await response.json();\n        const balance = BigInt(parseInt(data.result, 16) || \"0\");\n\n        return {\n          address,\n          chainId,\n          balance,\n          formattedBalance: formatTokenAmount(balance, 18, 4),\n          symbol: \"MOR\",\n          decimals: 18,\n        };\n      } catch {\n        console.error(`Failed to fetch balance on chain ${chainId}`);\n        return null;\n      }\n    },\n    [address]\n  );\n\n  // Fetch all balances\n  const refetch = useCallback(async () => {\n    if (!enabled || !isConnected || !address) return;\n\n    const chains = [8453, 42161]; // Base and Arbitrum\n    const results = await Promise.all(chains.map((chainId) => fetchBalance(chainId)));\n\n    const newBalances: Record<number, BalanceData> = {};\n    results.forEach((result) => {\n      if (result) {\n        newBalances[result.chainId] = result;\n      }\n    });\n\n    setBalances(newBalances);\n    setLastUpdated(new Date());\n  }, [address, enabled, isConnected, fetchBalance]);\n\n  // Set up polling\n  useEffect(() => {\n    if (!enabled || !isConnected) return;\n\n    refetch();\n\n    const intervalId = setInterval(refetch, pollInterval);\n\n    return () => clearInterval(intervalId);\n  }, [enabled, isConnected, pollInterval, refetch]);\n\n  // Total balance across all chains\n  const totalBalance = useMemo(() => {\n    return Object.values(balances).reduce(\n      (total, balance) => total + balance.balance,\n      0n\n    );\n  }, [balances]);\n\n  const formattedTotalBalance = useMemo(() => {\n    return formatTokenAmount(totalBalance, 18, 4);\n  }, [totalBalance]);\n\n  return {\n    balances,\n    totalBalance,\n    formattedTotalBalance,\n    refetch,\n    lastUpdated,\n    isLoading: !lastUpdated && isConnected,\n  };\n}\n",
      "type": "registry:hook"
    }
  ]
}